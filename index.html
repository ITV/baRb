<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Interface to BARB's Spot API • baRb</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Interface to BARB's Spot API">
<meta name="description" content="Interface to BARB's API">
<meta property="og:description" content="Interface to BARB's API">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">baRb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/daily-impacts-chart.html">daily-impacts-chart</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="barb">baRb<a class="anchor" aria-label="anchor" href="#barb"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>Functions for working with BARB’s TV spot API</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<pre><code><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ITV/baRb"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>BaRb requires a username and password to be set using environment variables. Use these commands or set the values in your .Renviron file.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>BARB_API_USERNAME <span class="op">=</span> <span class="st">"username"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>BARB_API_PASSWORD <span class="op">=</span> <span class="st">"password"</span><span class="op">)</span></span></code></pre>
<p>Get a list of available advertisers with:</p>
<pre><code><span><span class="fu"><a href="reference/barb_get_advertisers.html">barb_get_advertisers</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>And a spot list for a specific advertiser with:</p>
<pre><code><span><span class="fu"><a href="reference/barb_get_spots.html">barb_get_spots</a></span><span class="op">(</span></span>
<span>  min_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  max_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  advertiser_name <span class="op">=</span> <span class="st">"HAYS TRAVEL"</span>,</span>
<span>  async <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<p>Or programme data with:</p>
<pre><code><span><span class="fu"><a href="reference/barb_get_programmes.html">barb_get_programmes</a></span><span class="op">(</span></span>
<span>  min_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  max_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  station_code <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  async <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
<p>Official documentation for BARB’s API can be found <a href="https://barb-api.co.uk/api-docs" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="sync-and-async-queries">Sync and async queries<a class="anchor" aria-label="anchor" href="#sync-and-async-queries"></a>
</h3>
<p>BARB’s API has two sets of endpoints. ‘Sync’ endpoints return data immediately as json while ‘async’ endpoints initiate a query that runs on the server and results are downloaded as fragmented parquet files by a second API query once they are ready.</p>
<p>baRb wraps these two types of endpoints with a convenient switching option so that you can query either the sync or async endpoints and obtain a tibble of results in exactly the same format.</p>
<p>The following code will use the async endpoint to run a query:</p>
<pre><code><span><span class="fu"><a href="reference/barb_get_spots.html">barb_get_spots</a></span><span class="op">(</span></span>
<span>  min_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  max_transmission_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  advertiser_name <span class="op">=</span> <span class="st">"HAYS TRAVEL"</span>,</span>
<span>  async <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p>Sync endpoints return results faster for small queries but will easily time out.</p>
<p>Functionality from previous versions of baRb that would retry timed-out sync queries has been removed. If a query times out you will now receive an error and a suggestion to switch to async=TRUE.</p>
<p>Unless you’re building an interactive application that needs to run small queries very quickly, you’re probably better off using <code>async = TRUE</code> and the baRb package now defaults to <code>async = TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="why-do-i-see-the-message-removing-duplicated-spots">Why do I see the message “Removing duplicated spots”?<a class="anchor" aria-label="anchor" href="#why-do-i-see-the-message-removing-duplicated-spots"></a>
</h3>
<p>when using <code><a href="reference/barb_get_spots.html">barb_get_spots()</a></code> you will see the message ‘Removing duplicated spots’ and the total number of rows returned by the function will be fewer than is reported by sync API status messages during the query. This difference is because BARB’s API returns data for many panel regions, which causes spot data to be duplicated. The baRb package filters panel regions and removes these duplicates for you.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache 2</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing baRb</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Neil Charles <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Neil Charles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
