[{"path":"http://io.itv.com/baRb/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Neil Charles. Maintainer.","code":""},{"path":"http://io.itv.com/baRb/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Charles N (2024). baRb: Interface BARB's Spot API. R package version 0.2.1, http://io.itv.com/baRb/.","code":"@Manual{,   title = {baRb: Interface to BARB's Spot API},   author = {Neil Charles},   year = {2024},   note = {R package version 0.2.1},   url = {http://io.itv.com/baRb/}, }"},{"path":"http://io.itv.com/baRb/index.html","id":"barb","dir":"","previous_headings":"","what":"Interface to BARB's Spot API","title":"Interface to BARB's Spot API","text":"Functions working BARB’s TV spot API","code":""},{"path":"http://io.itv.com/baRb/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Interface to BARB's Spot API","text":"","code":"remotes::install_github(\"ITV/baRb\")"},{"path":"http://io.itv.com/baRb/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting started","title":"Interface to BARB's Spot API","text":"BaRb requires username password set using environment variables. Use commands set values .Renviron file. Get list available advertisers : spot list specific advertiser : programme data : Official documentation BARB’s API can found .","code":"Sys.setenv(BARB_API_USERNAME = \"username\") Sys.setenv(BARB_API_PASSWORD = \"password\") barb_get_advertisers() barb_get_spots(   min_transmission_date = \"2024-01-01\",   max_transmission_date = \"2024-01-01\",   advertiser_name = \"HAYS TRAVEL\",   async = FALSE) barb_get_programmes(   min_transmission_date = \"2024-01-01\",   max_transmission_date = \"2024-01-01\",   station_code = 10,   async = FALSE )"},{"path":"http://io.itv.com/baRb/index.html","id":"sync-and-async-queries","dir":"","previous_headings":"","what":"Sync and async queries","title":"Interface to BARB's Spot API","text":"BARB’s API two sets endpoints. ‘Sync’ endpoints return data immediately json ‘async’ endpoints initiate query runs server results downloaded fragmented parquet files second API query ready. baRb wraps two types endpoints convenient switching option can query either sync async endpoints obtain tibble results exactly format. following code use async endpoint run query: Sync endpoints return results faster small queries easily time . Functionality previous versions baRb retry timed-sync queries removed. query times now receive error suggestion switch async=TRUE. Unless ’re building interactive application needs run small queries quickly, ’re probably better using async = TRUE baRb package now defaults async = TRUE.","code":"barb_get_spots(   min_transmission_date = \"2024-01-01\",   max_transmission_date = \"2024-01-01\",   advertiser_name = \"HAYS TRAVEL\",   async = TRUE)"},{"path":"http://io.itv.com/baRb/index.html","id":"why-do-i-see-the-message-removing-duplicated-spots","dir":"","previous_headings":"","what":"Why do I see the message “Removing duplicated spots”?","title":"Interface to BARB's Spot API","text":"using barb_get_spots() see message ‘Removing duplicated spots’ total number rows returned function fewer reported sync API status messages query. difference BARB’s API returns data many panel regions, causes spot data duplicated. baRb package filters panel regions removes duplicates .","code":""},{"path":"http://io.itv.com/baRb/reference/barb_add_female_audiences.html","id":null,"dir":"Reference","previous_headings":"","what":"Add missing audiences to a spot or programme impacts table — barb_add_female_audiences","title":"Add missing audiences to a spot or programme impacts table — barb_add_female_audiences","text":"Add missing audiences spot programme impacts table","code":""},{"path":"http://io.itv.com/baRb/reference/barb_add_female_audiences.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add missing audiences to a spot or programme impacts table — barb_add_female_audiences","text":"","code":"barb_add_female_audiences(impacts)"},{"path":"http://io.itv.com/baRb/reference/barb_add_female_audiences.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add missing audiences to a spot or programme impacts table — barb_add_female_audiences","text":"impacts output barb_get_spots() barb_get_programmes","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_advertisers.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the list of available advertiser names — barb_get_advertisers","title":"Get the list of available advertiser names — barb_get_advertisers","text":"Get list available advertiser names","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_advertisers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the list of available advertiser names — barb_get_advertisers","text":"","code":"barb_get_advertisers()"},{"path":"http://io.itv.com/baRb/reference/barb_get_advertisers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the list of available advertiser names — barb_get_advertisers","text":"character vector advertiser names","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_advertisers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the list of available advertiser names — barb_get_advertisers","text":"","code":"barb_get_advertisers() #> Error in barb_login(): Username or password not set"},{"path":"http://io.itv.com/baRb/reference/barb_get_panels.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a tibble of panel names — barb_get_panels","title":"Get a tibble of panel names — barb_get_panels","text":"Get tibble panel names","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_panels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a tibble of panel names — barb_get_panels","text":"","code":"barb_get_panels()"},{"path":"http://io.itv.com/baRb/reference/barb_get_panels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a tibble of panel names — barb_get_panels","text":"tibble available panels","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_panels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a tibble of panel names — barb_get_panels","text":"","code":"barb_get_panels() #> Error in barb_login(): Username or password not set"},{"path":"http://io.itv.com/baRb/reference/barb_get_programmes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a tibble of spots from the BARB API — barb_get_programmes","title":"Get a tibble of spots from the BARB API — barb_get_programmes","text":"Get tibble spots BARB API","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_programmes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a tibble of spots from the BARB API — barb_get_programmes","text":"","code":"barb_get_programmes(   min_transmission_date = NULL,   max_transmission_date = NULL,   station_code = \"\",   macro_regions = FALSE,   consolidated = TRUE,   use_reporting_days = FALSE,   async = TRUE )"},{"path":"http://io.itv.com/baRb/reference/barb_get_programmes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a tibble of spots from the BARB API — barb_get_programmes","text":"min_transmission_date Start date spot query max_transmission_date End date spot query station_code station code obtained barb_get_stations() macro_regions whether return macro standard region areas consolidated whether return consolidated live viewing. Defaults TRUE (consolidated). use_reporting_days whether use standard 24 hour clock BARB reporting clock. Defaults FALSE (standard 24 hour clock). async async API used?","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_programmes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a tibble of spots from the BARB API — barb_get_programmes","text":"tibble TV spots","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_programmes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a tibble of spots from the BARB API — barb_get_programmes","text":"","code":"# barb_get_programmes(min_transmission_date = '2024-01-01', max_transmission_date = '2024-01-01', station_code = 10)"},{"path":"http://io.itv.com/baRb/reference/barb_get_spots.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a tibble of spots from the BARB API — barb_get_spots","title":"Get a tibble of spots from the BARB API — barb_get_spots","text":"Get tibble spots BARB API","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_spots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a tibble of spots from the BARB API — barb_get_spots","text":"","code":"barb_get_spots(   min_transmission_date = NULL,   max_transmission_date = NULL,   advertiser_name = NULL,   consolidated = TRUE,   use_reporting_days = FALSE,   standardise_audiences = NULL,   metric = \"audience_size_hundreds\",   retry_on_initial_no_response = FALSE,   fail_on_unsuccessful_pagination = FALSE,   retries = 5,   pause_before_retry = 90,   remove_duplicates = TRUE,   async = TRUE )"},{"path":"http://io.itv.com/baRb/reference/barb_get_spots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a tibble of spots from the BARB API — barb_get_spots","text":"min_transmission_date Start date spot query max_transmission_date End date spot query advertiser_name Advertiser name. Get names barb_get_advertisers() consolidated whether return consolidated live viewing. Defaults TRUE (consolidated). use_reporting_days whether use standard 24 hour clock BARB reporting clock. Defaults FALSE (standard 24 hour clock). standardise_audiences whether standardise impacts spot time length. Options default standardisation (\"\"), \"using_duration\" \"using_rate_factors\". metric Either \"audience_size_hundreds\" return impacts, \"tvrs\" return TVR's retry_on_initial_no_response API responds data first page results, baRb retry? Pagination always automatically retry avoid incomplete datasets. fail_on_unsuccessful_pagination API still responded data results page retries, function fail? FALSE generate warning return results anyway. retries Number times retry page request responded data pause_before_retry Time seconds pause retrying. Helps avoid quick succession consecutive failed queries can trigger rate limiting. remove_duplicates BARB's API reports multiple panel_region definitions, create duplicate impacts (e.g. spots reported macro micro regions). duplicate impacts removed? async async API used?","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_spots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a tibble of spots from the BARB API — barb_get_spots","text":"tibble TV spots","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_spots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a tibble of spots from the BARB API — barb_get_spots","text":"","code":"#barb_get_spots(min_transmission_date = \"2023-01-01\", max_transmission_date = \"2023-01-31\", advertiser_name = \"HAYS TRAVEL\")"},{"path":"http://io.itv.com/baRb/reference/barb_get_stations.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a tibble of station names — barb_get_stations","title":"Get a tibble of station names — barb_get_stations","text":"Get tibble station names","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_stations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a tibble of station names — barb_get_stations","text":"","code":"barb_get_stations()"},{"path":"http://io.itv.com/baRb/reference/barb_get_stations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a tibble of station names — barb_get_stations","text":"tibble available stations","code":""},{"path":"http://io.itv.com/baRb/reference/barb_get_stations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a tibble of station names — barb_get_stations","text":"","code":"barb_get_stations() #> Error in barb_login(): Username or password not set"},{"path":"http://io.itv.com/baRb/reference/barb_manage_query.html","id":null,"dir":"Reference","previous_headings":"","what":"Manages sync and async queries with retries for timeout problems on sync queries. Called by barb_get_spots() and barb_get_programmes(). Not called directly by users. — barb_manage_query","title":"Manages sync and async queries with retries for timeout problems on sync queries. Called by barb_get_spots() and barb_get_programmes(). Not called directly by users. — barb_manage_query","text":"Manages sync async queries retries timeout problems sync queries. Called barb_get_spots() barb_get_programmes(). called directly users.","code":""},{"path":"http://io.itv.com/baRb/reference/barb_manage_query.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Manages sync and async queries with retries for timeout problems on sync queries. Called by barb_get_spots() and barb_get_programmes(). Not called directly by users. — barb_manage_query","text":"","code":"barb_manage_query(   query_url = NULL,   query_params = list(),   metric = \"audience_size_hundreds\",   retry_on_initial_no_response = FALSE,   fail_on_unsuccessful_pagination = FALSE,   retries = 5,   pause_before_retry = 90,   async = FALSE,   json_processor = NULL )"},{"path":"http://io.itv.com/baRb/reference/barb_manage_query.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Manages sync and async queries with retries for timeout problems on sync queries. Called by barb_get_spots() and barb_get_programmes(). Not called directly by users. — barb_manage_query","text":"query_url API url e.g. barb_url_programmes() query_params list query parameters metric Either \"audience_size_hundreds\" return impacts, \"tvrs\" return TVR's retry_on_initial_no_response API responds data first page results, baRb retry? Pagination always automatically retry avoid incomplete datasets. fail_on_unsuccessful_pagination API still responded data results page retries, function fail? FALSE generate warning return results anyway. retries Number times retry page request responded data pause_before_retry Time seconds pause retrying. Helps avoid quick succession consecutive failed queries can trigger rate limiting. async async API used? json_processor json processing function e.g. process_spot_json. Pass without brackets().","code":""},{"path":"http://io.itv.com/baRb/reference/barb_query_api.html","id":null,"dir":"Reference","previous_headings":"","what":"Submit a query to the BARB API. Not called directly by users. — barb_query_api","title":"Submit a query to the BARB API. Not called directly by users. — barb_query_api","text":"Submit query BARB API. called directly users.","code":""},{"path":"http://io.itv.com/baRb/reference/barb_query_api.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Submit a query to the BARB API. Not called directly by users. — barb_query_api","text":"","code":"barb_query_api(url, query = list(), async = FALSE, async_check_interval = 20)"},{"path":"http://io.itv.com/baRb/reference/barb_query_api.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Submit a query to the BARB API. Not called directly by users. — barb_query_api","text":"url Endpoint URL query List query parameters","code":""},{"path":"http://io.itv.com/baRb/reference/barb_query_api.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Submit a query to the BARB API. Not called directly by users. — barb_query_api","text":"API results json async = FALSE download URLs async = TRUE","code":""},{"path":"http://io.itv.com/baRb/reference/barb_rollup_spots.html","id":null,"dir":"Reference","previous_headings":"","what":"Roll up raw spot data by broadcast time — barb_rollup_spots","title":"Roll up raw spot data by broadcast time — barb_rollup_spots","text":"Roll raw spot data broadcast time","code":""},{"path":"http://io.itv.com/baRb/reference/barb_rollup_spots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Roll up raw spot data by broadcast time — barb_rollup_spots","text":"","code":"barb_rollup_spots(spots, plus_one = TRUE, hd = TRUE)"},{"path":"http://io.itv.com/baRb/reference/barb_rollup_spots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Roll up raw spot data by broadcast time — barb_rollup_spots","text":"spots raw spot file plus_one Roll +1 channels? (T/F) hd Roll HD channels? (T/F)","code":""},{"path":"http://io.itv.com/baRb/reference/barb_rollup_spots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Roll up raw spot data by broadcast time — barb_rollup_spots","text":"tibble rolled spots","code":""},{"path":"http://io.itv.com/baRb/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"http://io.itv.com/baRb/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"http://io.itv.com/baRb/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"http://io.itv.com/baRb/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""}]
